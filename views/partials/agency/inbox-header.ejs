<!-- My Applicants Page Header -->
<%
  const safePipelineCounts = (typeof pipelineCounts !== 'undefined' && pipelineCounts) ? pipelineCounts : {
    all: 0,
    new: 0,
    pending: 0,
    'under-review': 0,
    accepted: 0,
    declined: 0,
    archived: 0
  };
  const currentStatus = (typeof filters !== 'undefined' && filters.status) ? filters.status : 'all';
%>
<section class="agency-applicants-header">
  <div class="agency-applicants-header__content">
    <div class="agency-applicants-header__top">
      <div class="agency-applicants-header__title-group">
        <h1 class="agency-applicants-header__title">My Applicants</h1>
        <p class="agency-applicants-header__subtitle">Total Applicants: <span id="applicants-total-count"><%= safePipelineCounts.all %></span></p>
      </div>
      
      <div class="agency-applicants-header__actions">
        <div class="agency-applicants-header__search">
          <svg class="agency-applicants-header__search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.35-4.35"/>
          </svg>
          <input 
            type="text" 
            placeholder="Search applicants by name, location, or tag..." 
            class="agency-applicants-header__search-input"
            id="applicants-search-input"
          />
        </div>
        
        <button class="agency-applicants-header__filters-btn" id="applicants-filters-btn" aria-label="Open filters">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
          </svg>
          Filters
        </button>
        
        <div class="agency-applicants-header__view-toggle" role="group" aria-label="View mode">
          <button 
            type="button" 
            class="agency-applicants-header__view-btn agency-applicants-header__view-btn--active" 
            data-view="pipeline"
            aria-label="Pipeline view"
            title="Pipeline (Kanban)"
          >
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7"/>
              <rect x="14" y="3" width="7" height="7"/>
              <rect x="14" y="14" width="7" height="7"/>
              <rect x="3" y="14" width="7" height="7"/>
            </svg>
          </button>
          <button 
            type="button" 
            class="agency-applicants-header__view-btn" 
            data-view="list"
            aria-label="List view"
            title="List"
          >
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="8" y1="6" x2="21" y2="6"/>
              <line x1="8" y1="12" x2="21" y2="12"/>
              <line x1="8" y1="18" x2="21" y2="18"/>
              <line x1="3" y1="6" x2="3.01" y2="6"/>
              <line x1="3" y1="12" x2="3.01" y2="12"/>
              <line x1="3" y1="18" x2="3.01" y2="18"/>
            </svg>
          </button>
          <button 
            type="button" 
            class="agency-applicants-header__view-btn" 
            data-view="gallery"
            aria-label="Gallery view"
            title="Gallery"
          >
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <polyline points="21 15 16 10 5 21"/>
            </svg>
          </button>
          <button 
            type="button" 
            class="agency-applicants-header__view-btn" 
            data-view="table"
            aria-label="Table view"
            title="Table"
          >
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Pipeline Visualization -->
    <div class="applicants-pipeline" id="applicants-pipeline">
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'all' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="all"
        data-count="<%= safePipelineCounts.all %>"
      >
        <span class="applicants-pipeline__stage-label">All</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.all %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'new' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="new"
        data-count="<%= safePipelineCounts.new %>"
      >
        <span class="applicants-pipeline__stage-label">New</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.new %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'pending' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="pending"
        data-count="<%= safePipelineCounts.pending %>"
      >
        <span class="applicants-pipeline__stage-label">Pending</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.pending %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'under-review' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="under-review"
        data-count="<%= safePipelineCounts['under-review'] %>"
      >
        <span class="applicants-pipeline__stage-label">Under Review</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts['under-review'] %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'accepted' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="accepted"
        data-count="<%= safePipelineCounts.accepted %>"
      >
        <span class="applicants-pipeline__stage-label">Accepted</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.accepted %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'declined' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="declined"
        data-count="<%= safePipelineCounts.declined %>"
      >
        <span class="applicants-pipeline__stage-label">Declined</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.declined %></span>
      </button>
      
      <div class="applicants-pipeline__connector"></div>
      
      <button 
        class="applicants-pipeline__stage <%= currentStatus === 'archived' ? 'applicants-pipeline__stage--active' : '' %>" 
        data-status="archived"
        data-count="<%= safePipelineCounts.archived %>"
      >
        <span class="applicants-pipeline__stage-label">Archived</span>
        <span class="applicants-pipeline__stage-count"><%= safePipelineCounts.archived %></span>
      </button>
    </div>
  </div>
</section>

