<!-- Trending Talent Sections -->
<% 
  // Get user's city or default
  const userCity = currentUser && currentUser.city ? currentUser.city : 'PARIS';
  
  // Trending in city (most viewed/recent in that city)
  const trendingInCity = safeProfiles.filter(p => {
    if (!p.city) return false;
    return p.city.toLowerCase() === userCity.toLowerCase();
  }).slice(0, 8);
  
  // New faces (created in last 24 hours)
  const newFaces = safeProfiles.filter(p => {
    if (!p.created_at) return false;
    const daysSinceCreated = Math.floor((new Date() - new Date(p.created_at)) / (1000 * 60 * 60 * 24));
    return daysSinceCreated <= 1;
  }).slice(0, 8);
%>

<!-- Trending in City Section -->
<% if (trendingInCity.length > 0) { %>
  <section class="discover-trending">
    <div class="discover-trending__header">
      <div class="discover-trending__title-group">
        <h2 class="discover-trending__title">TRENDING IN <%= userCity.toUpperCase() %></h2>
      </div>
      <button class="discover-trending__view-all" id="trending-city-view-all">
        View All
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>
    
    <div class="discover-trending__carousel" id="trending-city-carousel">
      <div class="discover-trending__track">
        <% trendingInCity.forEach((profile) => { %>
          <%- include('./discover-trending-card', { profile }) %>
        <% }); %>
      </div>
    </div>
    
    <!-- Carousel Controls -->
    <div class="discover-trending__controls">
      <button class="discover-trending__control discover-trending__control--prev" id="trending-city-prev" aria-label="Previous">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
      </button>
      <button class="discover-trending__control discover-trending__control--next" id="trending-city-next" aria-label="Next">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>
  </section>
<% } %>

<!-- New Faces Section -->
<% if (newFaces.length > 0) { %>
  <section class="discover-trending discover-trending--new-faces">
    <div class="discover-trending__header">
      <div class="discover-trending__title-group">
        <h2 class="discover-trending__title">NEW FACES</h2>
        <p class="discover-trending__subtitle">LAST 24H</p>
      </div>
      <button class="discover-trending__view-all" id="new-faces-view-all">
        View All
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>
    
    <div class="discover-trending__carousel" id="new-faces-carousel">
      <div class="discover-trending__track">
        <% newFaces.forEach((profile) => { %>
          <%- include('./discover-trending-card', { profile }) %>
        <% }); %>
      </div>
    </div>
    
    <!-- Carousel Controls -->
    <div class="discover-trending__controls">
      <button class="discover-trending__control discover-trending__control--prev" id="new-faces-prev" aria-label="Previous">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
      </button>
      <button class="discover-trending__control discover-trending__control--next" id="new-faces-next" aria-label="Next">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>
  </section>
<% } %>
